{{- define "main" }}

{{- if (and site.Params.profileMode.enabled .IsHome) }}
<div class="profile" style="max-width: 900px; margin: 3rem auto; padding: 0 1.5rem;">
  {{- partial "index_profile.html" . }}
</div>
{{- end }}

{{- if site.Params.homeInfoParams }}
<div class="home-info" style="max-width: 900px; margin: 3rem auto; padding: 0 1.5rem;">
  {{- partial "home_info.html" . }}
</div>
{{- end }}

{{- /* Se√ß√£o "Como Funciona" */ -}}
{{- partial "how_it_works.html" . }}

{{- $pages := union .RegularPages .Sections }}
{{- if .IsHome }}
  {{- $pages = where site.RegularPages "Type" "in" site.Params.mainSections }}
  {{- $pages = where $pages "Params.hiddenInHomeList" "!=" "true" }}
{{- end }}
{{- $paginator := .Paginate $pages }}

{{- if and .IsHome site.Params.homeInfoParams }}
<header class="page-header" style="max-width: 900px; margin: 2rem auto 1rem; padding: 0 1.5rem;">
  <h2 style="font-family: 'Inter', sans-serif; font-size: 2rem; font-weight: 700; color: #1e293b; margin-bottom: 0.5rem;">
    üìù √öltimos Artigos
  </h2>
  <p style="color: #64748b; font-size: 1.0625rem;">
    Fique por dentro das novidades em IA de voz e automa√ß√£o de atendimento
  </p>
</header>
{{- end }}

<div id="content" style="max-width: 1200px; margin: 0 auto; padding: 0 1.5rem;">
  {{- if eq $paginator.NumberOfElements 0 }}
  <div style="text-align: center; padding: 4rem 1.5rem;">
    <p style="font-size: 1.25rem; color: #64748b;">Nenhum post encontrado üîç</p>
  </div>
  {{- end }}

  {{- range $index, $page := $paginator.Pages }}
    {{- $class := "post-entry" }}

    {{- $user_preferred := or site.Params.disableSpecial1stPost site.Params.homeInfoParams }}
    {{- if (and $.IsHome (eq $paginator.PageNumber 1) (eq $index 0) (not $user_preferred)) }}
      {{- $class = "first-entry" }}
    {{- else if $page.Weight }}
      {{- $class = "post-entry featured" }}
    {{- end }}

    <article class="{{ $class }}" style="margin-bottom: 2rem;">
      {{- $isHidden := ($page.Param "cover.hiddenInList") | default ($page.Param "cover.hidden") | default false }}
      {{- partial "cover.html" (dict "cxt" . "IsHome" true "isHidden" $isHidden) }}
      <header class="entry-header">
        <h2 style="margin: 0 0 0.75rem 0; font-family: 'Inter', sans-serif;">
          {{- .Title }}
          {{- if .Draft }}<sup><span class="entry-isdraft" style="color: #ef4444;">&nbsp;&nbsp;[draft]</span></sup>{{- end }}
        </h2>
      </header>
      {{- if (ne (.Param "hideSummary") true) }}
      <div class="entry-content" style="color: #475569; font-size: 1.0625rem; line-height: 1.7; margin-bottom: 1rem;">
        <p>{{ .Summary | plainify | htmlUnescape }}{{ if .Truncated }}...{{ end }}</p>
      </div>
      {{- end }}
      {{- if not (.Param "hideMeta") }}
      <footer class="entry-footer" style="display: flex; align-items: center; gap: 1rem; flex-wrap: wrap; font-size: 0.875rem; color: #64748b; margin-bottom: 1rem;">
        {{- partial "post_meta.html" . -}}
      </footer>
      {{- end }}
      <a class="entry-link" href="{{ .Permalink }}" aria-label="post link to {{ .Title | plainify }}">
        Ler artigo completo
      </a>
    </article>
  {{- end }}
</div>

{{- if gt $paginator.TotalPages 1 }}
<footer class="page-footer" style="max-width: 1200px; margin: 3rem auto; padding: 0 1.5rem;">
  <nav class="pagination">
    {{- if $paginator.HasPrev }}
    <a class="prev" href="{{ $paginator.Prev.URL }}">
      ¬´ Anterior
    </a>
    {{- end }}
    {{- range $paginator.Pagers }}
    {{- if eq . $paginator }}
    <span class="active">{{ .PageNumber }}</span>
    {{- else }}
    <a href="{{ .URL }}">{{ .PageNumber }}</a>
    {{- end }}
    {{- end }}
    {{- if $paginator.HasNext }}
    <a class="next" href="{{ $paginator.Next.URL }}">
      Pr√≥xima ¬ª
    </a>
    {{- end }}
  </nav>
</footer>
{{- end }}

{{- end }}{{/* end main */}}
